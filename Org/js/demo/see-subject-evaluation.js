/**
 * Created by humorHan on 2016/9/20.
 */
var data = {
    "Data": {
        "SubGrasp": [{
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000102",
            "ParentPointName": "熔化和凝固",
            "PointID": "2101",
            "PointName": "熔化",
            "PTotalCount": 2,
            "PRightCount": 1,
            "Degree": "重点",
            "EstimateValue": 2,
            "PointLevel": "常考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 1,
            "PCN": "部分掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000202",
            "ParentPointName": "声音的特性和利用",
            "PointID": "2054",
            "PointName": "音调",
            "PTotalCount": 2,
            "PRightCount": 1,
            "Degree": "",
            "EstimateValue": 2,
            "PointLevel": "选考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 1,
            "PCN": "部分掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000308",
            "ParentPointName": "显微镜和望远镜",
            "PointID": "2090",
            "PointName": "望远镜",
            "PTotalCount": 2,
            "PRightCount": 1,
            "Degree": "难点",
            "EstimateValue": 1,
            "PointLevel": "少考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 1,
            "PCN": "部分掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000428",
            "ParentPointName": "机械效率",
            "PointID": "2199",
            "PointName": "滑轮组的机械效率",
            "PTotalCount": 4,
            "PRightCount": 3,
            "Degree": "重难点",
            "EstimateValue": 8,
            "PointLevel": "必考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 1,
            "PCN": "部分掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000101",
            "ParentPointName": "温度和温度计",
            "PointID": "2105",
            "PointName": "温度",
            "PTotalCount": 3,
            "PRightCount": 0,
            "Degree": "重点",
            "EstimateValue": 3,
            "PointLevel": "常考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 0,
            "PCN": "未掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000203",
            "ParentPointName": "噪声的危害和控制",
            "PointID": "2049",
            "PointName": "噪声的控制",
            "PTotalCount": 1,
            "PRightCount": 0,
            "Degree": "",
            "EstimateValue": 1,
            "PointLevel": "少考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 0,
            "PCN": "未掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000301",
            "ParentPointName": "光的直线传播",
            "PointID": "2081",
            "PointName": "光的传播速度与光年",
            "PTotalCount": 2,
            "PRightCount": 0,
            "Degree": "",
            "EstimateValue": 1,
            "PointLevel": "选考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 0,
            "PCN": "未掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000401",
            "ParentPointName": "长度和时间的测量",
            "PointID": "7954",
            "PointName": "长度的测量结果",
            "PTotalCount": 2,
            "PRightCount": 0,
            "Degree": "",
            "EstimateValue": 1,
            "PointLevel": "必考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 0,
            "PCN": "未掌握"
        }, {
            "GraspID": 0,
            "PaperID": 0,
            "TempID": 0,
            "ParentPointID": "0c00000508",
            "ParentPointName": "电阻",
            "PointID": "2305",
            "PointName": "半导体和超导材料",
            "PTotalCount": 3,
            "PRightCount": 0,
            "Degree": "",
            "EstimateValue": 1,
            "PointLevel": "少考",
            "CreateTime": "\/Date(-62135596800000)\/",
            "PC": 0,
            "PCN": "未掌握"
        }],
        "SubDiff": [{
            "DiffictyID": 0,
            "TempID": 0,
            "PaperID": 0,
            "DiffictyCode": 5,
            "DiffictyName": "困难",
            "TotalCount": 4,
            "RightCount": 0,
            "AnswerTime": 10,
            "RightRate": "0",
            "ExpectRate": "70",
            "UpdateExpectRate": "100",
            "IsUpdate": 1,
            "CreateTime": "\/Date(-62135596800000)\/",
            "SubjectID": 0,
            "StageID": 0
        }, {
            "DiffictyID": 0,
            "TempID": 0,
            "PaperID": 0,
            "DiffictyCode": 4,
            "DiffictyName": "较难",
            "TotalCount": 2,
            "RightCount": 1,
            "AnswerTime": 3,
            "RightRate": "50",
            "ExpectRate": "75",
            "UpdateExpectRate": "90",
            "IsUpdate": 1,
            "CreateTime": "\/Date(-62135596800000)\/",
            "SubjectID": 0,
            "StageID": 0
        }, {
            "DiffictyID": 0,
            "TempID": 0,
            "PaperID": 0,
            "DiffictyCode": 3,
            "DiffictyName": "中等",
            "TotalCount": 4,
            "RightCount": 0,
            "AnswerTime": 9,
            "RightRate": "0",
            "ExpectRate": "80",
            "UpdateExpectRate": "88",
            "IsUpdate": 1,
            "CreateTime": "\/Date(-62135596800000)\/",
            "SubjectID": 0,
            "StageID": 0
        }, {
            "DiffictyID": 0,
            "TempID": 0,
            "PaperID": 0,
            "DiffictyCode": 2,
            "DiffictyName": "较易",
            "TotalCount": 7,
            "RightCount": 3,
            "AnswerTime": 12,
            "RightRate": "43",
            "ExpectRate": "85",
            "UpdateExpectRate": "66",
            "IsUpdate": 1,
            "CreateTime": "\/Date(-62135596800000)\/",
            "SubjectID": 0,
            "StageID": 0
        }, {
            "DiffictyID": 0,
            "TempID": 0,
            "PaperID": 0,
            "DiffictyCode": 1,
            "DiffictyName": "容易",
            "TotalCount": 4,
            "RightCount": 2,
            "AnswerTime": 4,
            "RightRate": "50",
            "ExpectRate": "90",
            "UpdateExpectRate": "77",
            "IsUpdate": 1,
            "CreateTime": "\/Date(-62135596800000)\/",
            "SubjectID": 0,
            "StageID": 0
        }],
        "StageIDN": "初中",
        "StageSubN": "初中物理",
        "EditTimeN": "06-17 17:29",
        "ResultLevelN": "E→A",
        "MeasureID": 42,
        "ExamID": 99,
        "ExamName": "八年级物理",
        "EditTime": "\/Date(1466155778000)\/",
        "GradeID": "c3",
        "ReportDescResult": "第①阶段：首先以巩固基础知识和精讲基本题型为主，重点放到基本知识的理解上，再适当进行重点题型的讲解；练习难度以较易为主。\u003cbr style=\"height:25px;\"\u003e第②阶段：以巩固重点难点和训练基本题型为主，重点放到重点题型的讲解和训练上，以变式练习为主；练习难度以一般为主。\u003cbr style=\"height:25px;\"\u003e第③阶段：再以知识整合为主，突破疑难问题。重点放到重点题型的训练上，帮助其熟悉掌握重点题型，并进行适当拓展和提升。练习难度以中等、较难为主。\u003cbr style=\"height:25px;\"\u003e第④阶段：最后不断加强对知识、思维方法维度的归纳总结，进而形成完善的知识结构。通过针对性的思维方法训练，完善并补充思维方法，形成知识、思维方式、解题思想三维度知识结构。练习难度以较难、困难为主。",
        "ResultLevel": "E",
        "StageID": "c",
        "SubjectID": "04",
        "SubjectIDN": "物理",
        "TotalHour": 33,
        "TempName": "八年级物理"
    },
    "Per": [],
    "TokenID": null,
    "OK": true,
    "Code": null,
    "Result": "OK",
    "TagValue": null,
    "PageIndex": 0,
    "PageSum": 0
};
var totalData;
var config = require('util/config.js');
var echarts = require('echarts.min.js');

var demo = {
    init: function () {
        this.requestData();
        //YD
        this.YD();
        //HJY
        this.HJY();
        //ZY
        this.ZY();
    },
    requestData: function () {
        // 学科数据
        /*$.ajax({
         type: 'post',
         url: '/OrgExam/Exam/GetSubReport',
         data: {
         },
         success: function(dt){
         data = dt;
         }
         });*/
        /*console.log(data);*/
        // 全科综合数据
        $.ajax({
            type: 'post',
            url: '/OrgExam/Exam/GetReport',
            data: {
            },
            success: function(dt){
                totalData = dt;
            }
        });
    },

    YD: function(){
        var myChart = echarts.init(document.getElementById('diff-level'));
        var expectRate=[];
        var rightRate=[];
        var diffName=[];
        $.each(data.Data.SubDiff,function(i,value){
            expectRate.push(value.ExpectRate);
            rightRate.push(value.RightRate);
            diffName.push(value.DiffictyName);
        });
        var option = {
            color:["#92c5d1","#b7ca6d"],
            title: {
                text: '不同难度分布答题正确率',
                left:"center",
                textStyle:{
                    fontSize :14,
                    fontWeight:"normal"
                },
                top:"5%"
            },
            legend: {
                top:"20%",
                right:"26%",
                data: [ '目标正确率','你的正确率'],
                orient: 'vertical'
            },
            grid: {
                left: '3%',
                right: '50%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                min:0,
                max:100,
                axisLabel: {
                    show: true,
                    interval: 'auto',
                    formatter: '{value} %'
                }
            },
            yAxis: {
                type: 'category',
                data: diffName
            },
            series: [
                {
                    name: '目标正确率',
                    type: 'bar',
                    data:expectRate,
                    markPoint:{
                        data : [
                            {type : 'circle'}
                        ]
                    },
                    label: {
                        normal: {
                            show: true,
                            formatter: '{c} %',
                            position: 'right'
                        }
                    }
                },
                {
                    name: '你的正确率',
                    type: 'bar',
                    data: rightRate,
                    label: {
                        normal: {
                            show: true,
                            formatter: '{c} %',
                            position: 'right'
                        }
                    }
                }
            ]
        };
        myChart.setOption(option);
    },

    HJY: function () {
        //本测试知识点权重比例
        this.knowledgeWeight();
        //本试卷难度分布图
        this.difficultyDistribution();
    },

    knowledgeWeight: function () {
        var myChart = echarts.init(document.getElementById('knowledge-weight'));
        var weightData = data.Data.SubGrasp;
        var legend = [], seriesData = [];

        weightData.forEach(function (item) {
            legend.push(item.PointName);
            seriesData.push({
                name: item.PointName,
                value: item.PTotalCount
            });
        });
        myChart.setOption({
            title: {
                text: '本测试知识点权重比例',
                left: 'center',
                textStyle: {
                    fontSize: 14,
                    fontWeight: 'normal'
                }
            },
            legend: {
                orient: 'vertical',
                right: '10%',
                top: '35',
                bottom: '20',
                data: legend
            },
            series: [
                {
                    type: 'pie',
                    label: {
                        normal: {
                            show: true,
                            formatter: '{b}: {d}%'
                        }
                    },
                    radius: ['50%', '70%'],
                    center: ['35%', '50%'],
                    data: seriesData
                }
            ]
        });
    },

    difficultyDistribution: function () {
        var myChart = echarts.init(document.getElementById('difficulty-distribution'));
        var difficultyData = data.Data.SubDiff;
        var legend = [], seriesData = [];

        difficultyData.forEach(function (item) {
            legend.push(item.DiffictyName);
            seriesData.push({
                name: item.DiffictyName,
                value: item.TotalCount
            });
        });
        myChart.setOption({
            title:{
                text: '本试卷难度分布图',
                left: 'center',
                textStyle: {
                    fontSize: 14,
                    fontWeight: 'normal'
                }
            },
            legend: {
                orient: 'vertical',
                right: '10%',
                top: '20',
                bottom: '20',
                data: legend
            },
            series: [
                {
                    type: 'pie',
                    label:{
                        normal: {
                            show: true,
                            formatter: '{b}: {d}%'
                        }
                    },
                    radius: ['40%', '60%'],
                    center : ['40%', '50%'],
                    data: seriesData
                }
            ]
        });
    },

    ZY: function () {
        //考点掌握程度图
        var myChart = echarts.init(document.getElementById('process_nowlage'));
        var weightData = data.Data.SubGrasp;
        var legend = [], seriesData = [];
        weightData.forEach(function (item) {
            legend.push(item.PointName);
            seriesData.push({
                name: item.PointName,
                value: item.PTotalCount
            });
        });
        myChart.setOption({
            color: config.baseColor,
            title: {
                text: '本测试知识点权重比例',
                left: 'center',

                textStyle: {
                    fontSize: 14,
                    fontWeight: 'normal'
                }
            },
            legend: {
                orient: 'vertical',
                right: '10%',
                top: '35',
                bottom: '20',
                data: legend
            },
            series: [
                {
                    label: {
                        normal: {
                            show: true,
                            formatter: '{b}:{c}%'
                        }
                    },
                    type: 'pie',
                    radius: ['30%', '70%'],
                    center: ['30%', '50%'],
                    data: seriesData
                }
            ]
        });
    }
};

$(function () {
    demo.init();
});